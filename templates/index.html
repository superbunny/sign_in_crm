<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CanadaLogin CRM</title>
    <meta name="description"
        content="Internal CRM system for managing government department relationships with the sign-in service">
    <link rel="stylesheet" href="/static/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-container">
            <div class="header-brand">
                <a href="/" class="gc-signature-link">
                    <img src="https://www.canada.ca/etc/designs/canada/wet-boew/assets/sig-blk-en.svg"
                        alt="Government of Canada" class="gc-signature">
                </a>
                <div class="app-title-container">
                    <h1 class="app-title">CanadaLogin CRM</h1>
                </div>
            </div>
            <nav class="header-nav">
                <button class="nav-btn active" data-view="dashboard">Dashboard</button>
                <button class="nav-btn" data-view="departments">Departments</button>
                <button class="nav-btn" data-view="applications">Applications</button>
                <button class="nav-btn" data-view="integrations">Integrations</button>
                <button class="nav-btn" data-view="contacts">Contacts</button>
                <button class="nav-btn" data-view="activities">Activities</button>
                <button class="nav-btn" data-view="incidents">Incidents</button>
                <button class="nav-btn" data-view="tags">Tags</button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard View -->
        <section id="view-dashboard" class="view active">
            <div class="view-header">
                <h2>Dashboard</h2>
                <p class="view-subtitle">Overview of Identity Service relationships and operations</p>
            </div>

            <div class="stats-grid">
                <div class="stat-card stat-departments">
                    <div class="stat-icon">üèõÔ∏è</div>
                    <div class="stat-info">
                        <span class="stat-value" id="stat-total-departments">-</span>
                        <span class="stat-label">Total Departments</span>
                    </div>
                    <div class="stat-secondary">
                        <span id="stat-active-departments">-</span> active ‚Ä¢ <span
                            id="stat-critical-departments">-</span> critical
                    </div>
                </div>

                <div class="stat-card stat-applications">
                    <div class="stat-icon">üì±</div>
                    <div class="stat-info">
                        <span class="stat-value" id="stat-total-applications">-</span>
                        <span class="stat-label">Applications</span>
                    </div>
                    <div class="stat-secondary">
                        <span id="stat-live-applications">-</span> live ‚Ä¢ <span
                            id="stat-integrating-applications">-</span> integrating
                    </div>
                </div>

                <div class="stat-card stat-risk">
                    <div class="stat-icon">‚ö†Ô∏è</div>
                    <div class="stat-info">
                        <span class="stat-value" id="stat-high-risk">-</span>
                        <span class="stat-label">High-Risk Integrations</span>
                    </div>
                    <div class="stat-secondary">
                        <span id="stat-blocked">-</span> blocked ‚Ä¢ <span id="stat-delayed">-</span> delayed
                    </div>
                </div>

                <div class="stat-card stat-incidents">
                    <div class="stat-icon">üî¥</div>
                    <div class="stat-info">
                        <span class="stat-value" id="stat-open-incidents">-</span>
                        <span class="stat-label">Open Incidents</span>
                    </div>
                </div>
            </div>

            <!-- AI Chat Panel -->
            <div class="chat-panel">
                <div class="chat-header">
                    <div class="chat-header-left">
                        <h3>ü§ñ AI Assistant</h3>
                        <span class="chat-subtitle">Ask questions about your data</span>
                    </div>
                    <div class="chat-header-actions">
                        <button id="chat-clear" class="btn btn-sm btn-secondary" title="Clear History">üóëÔ∏è
                            Clear</button>
                        <button id="chat-new" class="btn btn-sm btn-secondary" title="New Chat">‚ú® New Chat</button>
                    </div>
                </div>
                <div class="chat-messages" id="chat-messages">
                    <div class="chat-message assistant">
                        <p>Hello! I'm your AI assistant. Ask me questions about departments, applications, integrations,
                            and more.</p>
                        <p style="color: #666; font-size: 0.9em;">Try: "Which departments are critical?" or "Show me a
                            chart of applications by status"</p>
                    </div>
                </div>
                <div class="chat-input-container">
                    <input type="text" id="chat-input" class="chat-input" placeholder="Ask a question..."
                        autocomplete="off">
                    <button id="chat-send" class="chat-send-btn">Send</button>
                </div>
            </div>
        </section>

        <!-- Departments View -->
        <section id="view-departments" class="view">
            <div class="view-header">
                <h2>Departments</h2>
                <button class="btn btn-primary" onclick="showAddDepartmentModal()">+ Add Department</button>
            </div>
            <div class="filter-bar" id="filter-departments">
                <div class="filter-group">
                    <label>Tier</label>
                    <select id="filter-dept-tier" onchange="renderDepartments()">
                        <option value="">All Tiers</option>
                        <option value="standard">Standard</option>
                        <option value="critical">Critical</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Status</label>
                    <select id="filter-dept-status" onchange="renderDepartments()">
                        <option value="">All Statuses</option>
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Owner Team</label>
                    <select id="filter-dept-owner" onchange="renderDepartments()">
                        <option value="">All Teams</option>
                    </select>
                </div>
                <div class="filter-separator"></div>
                <div class="filter-group">
                    <label>Search</label>
                    <input type="text" id="filter-dept-search" placeholder="Search departments..."
                        oninput="renderDepartments()">
                </div>
                <button class="btn-reset" onclick="resetFilters('departments')">‚úï Reset</button>
            </div>
            <div class="table-container">
                <table class="data-table" id="departments-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Short Name</th>
                            <th>Tier</th>
                            <th>Status</th>
                            <th>Owner Team</th>
                            <th>Apps</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <!-- Applications View -->
        <section id="view-applications" class="view">
            <div class="view-header">
                <h2>Applications</h2>
                <button class="btn btn-primary" onclick="showAddApplicationModal()">+ Add Application</button>
            </div>
            <div class="filter-bar" id="filter-applications">
                <div class="filter-group">
                    <label>Department</label>
                    <select id="filter-app-dept" onchange="renderApplications()">
                        <option value="">All Departments</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Environment</label>
                    <select id="filter-app-env" onchange="renderApplications()">
                        <option value="">All Environments</option>
                        <option value="prod">Production</option>
                        <option value="test">Test</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Auth Type</label>
                    <select id="filter-app-auth" onchange="renderApplications()">
                        <option value="">All Auth Types</option>
                        <option value="OIDC">OIDC</option>
                        <option value="SAML">SAML</option>
                        <option value="legacy">Legacy</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Status</label>
                    <select id="filter-app-status" onchange="renderApplications()">
                        <option value="">All Statuses</option>
                        <option value="integrating">Integrating</option>
                        <option value="live">Live</option>
                        <option value="deprecated">Deprecated</option>
                    </select>
                </div>
                <div class="filter-separator"></div>
                <div class="filter-group">
                    <label>Search</label>
                    <input type="text" id="filter-app-search" placeholder="Search applications..."
                        oninput="renderApplications()">
                </div>
                <button class="btn-reset" onclick="resetFilters('applications')">‚úï Reset</button>
            </div>
            <div class="table-container">
                <table class="data-table" id="applications-table">
                    <thead>
                        <tr>
                            <th>Application</th>
                            <th>Department</th>
                            <th>Environment</th>
                            <th>Auth Type</th>
                            <th>Status</th>
                            <th>Go-Live Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <!-- Integrations View -->
        <section id="view-integrations" class="view">
            <div class="view-header">
                <h2>Integration Status</h2>
                <p class="view-subtitle">Track integration progress for all applications</p>
            </div>
            <div class="filter-bar" id="filter-integrations">
                <div class="filter-group">
                    <label>Department</label>
                    <select id="filter-int-dept" onchange="renderIntegrations()">
                        <option value="">All Departments</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Stage</label>
                    <select id="filter-int-stage" onchange="renderIntegrations()">
                        <option value="">All Stages</option>
                        <option value="intake">Intake</option>
                        <option value="design">Design</option>
                        <option value="implementation">Implementation</option>
                        <option value="testing">Testing</option>
                        <option value="production">Production</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Status</label>
                    <select id="filter-int-status" onchange="renderIntegrations()">
                        <option value="">All Statuses</option>
                        <option value="on_track">On Track</option>
                        <option value="blocked">Blocked</option>
                        <option value="delayed">Delayed</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Risk Level</label>
                    <select id="filter-int-risk" onchange="renderIntegrations()">
                        <option value="">All Risk Levels</option>
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>
                <button class="btn-reset" onclick="resetFilters('integrations')">‚úï Reset</button>
            </div>
            <div class="table-container">
                <table class="data-table" id="integrations-table">
                    <thead>
                        <tr>
                            <th>Application</th>
                            <th>Department</th>
                            <th>Stage</th>
                            <th>Status</th>
                            <th>Risk Level</th>
                            <th>Last Updated</th>
                            <th>Notes</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <!-- Contacts View -->
        <section id="view-contacts" class="view">
            <div class="view-header">
                <h2>Contacts</h2>
                <button class="btn btn-primary" onclick="showAddContactModal()">+ Add Contact</button>
            </div>
            <div class="filter-bar" id="filter-contacts">
                <div class="filter-group">
                    <label>Department</label>
                    <select id="filter-con-dept" onchange="renderContacts()">
                        <option value="">All Departments</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Role</label>
                    <select id="filter-con-role" onchange="renderContacts()">
                        <option value="">All Roles</option>
                        <option value="business">Business</option>
                        <option value="technical">Technical</option>
                        <option value="security">Security</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Active</label>
                    <select id="filter-con-active" onchange="renderContacts()">
                        <option value="">All</option>
                        <option value="1">Yes</option>
                        <option value="0">No</option>
                    </select>
                </div>
                <div class="filter-separator"></div>
                <div class="filter-group">
                    <label>Search</label>
                    <input type="text" id="filter-con-search" placeholder="Search name or email..."
                        oninput="renderContacts()">
                </div>
                <button class="btn-reset" onclick="resetFilters('contacts')">‚úï Reset</button>
            </div>
            <div class="table-container">
                <table class="data-table" id="contacts-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Department</th>
                            <th>Role</th>
                            <th>Email</th>
                            <th>Phone</th>
                            <th>Active</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <!-- Activities View -->
        <section id="view-activities" class="view">
            <div class="view-header">
                <h2>Engagement Activities</h2>
                <button class="btn btn-primary" onclick="showAddActivityModal()">+ Add Activity</button>
            </div>
            <div class="filter-bar" id="filter-activities">
                <div class="filter-group">
                    <label>Department</label>
                    <select id="filter-act-dept" onchange="renderActivities()">
                        <option value="">All Departments</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Type</label>
                    <select id="filter-act-type" onchange="renderActivities()">
                        <option value="">All Types</option>
                        <option value="meeting">Meeting</option>
                        <option value="email">Email</option>
                        <option value="workshop">Workshop</option>
                        <option value="incident">Incident</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Owner</label>
                    <select id="filter-act-owner" onchange="renderActivities()">
                        <option value="">All Owners</option>
                    </select>
                </div>
                <div class="filter-separator"></div>
                <div class="filter-group">
                    <label>From</label>
                    <input type="date" id="filter-act-date-from" onchange="renderActivities()">
                </div>
                <div class="filter-group">
                    <label>To</label>
                    <input type="date" id="filter-act-date-to" onchange="renderActivities()">
                </div>
                <button class="btn-reset" onclick="resetFilters('activities')">‚úï Reset</button>
            </div>
            <div class="table-container">
                <table class="data-table" id="activities-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Type</th>
                            <th>Department</th>
                            <th>Application</th>
                            <th>Summary</th>
                            <th>Next Action</th>
                            <th>Owner</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <!-- Incidents View -->
        <section id="view-incidents" class="view">
            <div class="view-header">
                <h2>Incidents</h2>
                <button class="btn btn-primary" onclick="showAddIncidentModal()">+ Add Incident</button>
            </div>
            <div class="filter-bar" id="filter-incidents">
                <div class="filter-group">
                    <label>Severity</label>
                    <select id="filter-inc-severity" onchange="renderIncidents()">
                        <option value="">All Severities</option>
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                        <option value="critical">Critical</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Status</label>
                    <select id="filter-inc-status" onchange="renderIncidents()">
                        <option value="">All Statuses</option>
                        <option value="open">Open</option>
                        <option value="investigating">Investigating</option>
                        <option value="resolved">Resolved</option>
                        <option value="closed">Closed</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Application</label>
                    <select id="filter-inc-app" onchange="renderIncidents()">
                        <option value="">All Applications</option>
                    </select>
                </div>
                <div class="filter-separator"></div>
                <div class="filter-group">
                    <label>From</label>
                    <input type="date" id="filter-inc-date-from" onchange="renderIncidents()">
                </div>
                <div class="filter-group">
                    <label>To</label>
                    <input type="date" id="filter-inc-date-to" onchange="renderIncidents()">
                </div>
                <button class="btn-reset" onclick="resetFilters('incidents')">‚úï Reset</button>
            </div>
            <div class="table-container">
                <table class="data-table" id="incidents-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Application</th>
                            <th>Severity</th>
                            <th>Status</th>
                            <th>Description</th>
                            <th>Created</th>
                            <th>Resolved</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>

        <!-- Tag Management View -->
        <section id="view-tags" class="view">
            <div class="view-header">
                <h2>Tag Management</h2>
                <p class="view-subtitle">Manage tag values for dropdowns across the system</p>
            </div>

            <div class="tag-management-container">
                <div class="tag-category-selector">
                    <label for="tag-category-select"><strong>Select Category:</strong></label>
                    <select id="tag-category-select" onchange="loadTagsForCategory()">
                        <option value="">-- Select a category --</option>
                    </select>
                </div>

                <div id="tag-category-info" class="tag-category-info" style="display: none;">
                    <h3 id="tag-category-title"></h3>
                    <p id="tag-category-description"></p>
                    <button class="btn btn-primary" onclick="showAddTagModal()">+ Add Tag</button>
                </div>

                <div id="tags-table-container" class="table-container" style="display: none;">
                    <table class="data-table" id="tags-table">
                        <thead>
                            <tr>
                                <th>Label</th>
                                <th>Value</th>
                                <th>Color</th>
                                <th>Status</th>
                                <th>Sort Order</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <div id="no-category-selected" class="empty-state">
                    <p>üëà Select a category to manage its tags</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Modal Container -->
    <div class="modal-overlay" id="modal-overlay">
        <div class="modal" id="modal">
            <div class="modal-header">
                <h3 id="modal-title">Modal Title</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modal-body"></div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-info">
                <span>CanadaLogin CRM v1.0</span>
                <span>‚Ä¢</span>
                <span>Internal Use Only</span>
            </div>
            <div class="footer-brand">
                <img src="https://www.canada.ca/etc/designs/canada/wet-boew/assets/wmms-blk.svg"
                    alt="Symbol of the Government of Canada" class="gc-wordmark">
            </div>
        </div>
    </footer>

    <script src="/static/app.js"></script>
</body>

</html>